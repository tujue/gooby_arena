*,
*::before,
*::after {
  box-sizing: border-box;
}

canvas {
  display: block;
}

/* Hide scrollbars but keep functionality */
*::-webkit-scrollbar {
  display: none;
}

* {
  -ms-overflow-style: none;
  scrollbar-width: none;
}

:root {
  --font-main: 'Outfit', sans-serif;
  --primary: #6366f1;
  --primary-hover: #4f46e5;
  --accent: #ec4899;
  --bg-dark: #0f172a;
  --glass-bg: rgba(255, 255, 255, 0.05);
  --glass-border: rgba(255, 255, 255, 0.1);
  --text-main: #f8fafc;
  --text-muted: #94a3b8;
}

html,
body {
  margin: 0;
  padding: 0;
  width: 100%;
  height: 100dvh;
  /* Dynamic viewport height for mobile */
  min-height: 100vh;
  /* Fallback for older browsers */
  overflow: hidden;
  position: fixed;
  /* Prevents scroll bounce on mobile */
  touch-action: none;
  /* Disable touch gestures */
}

body {
  font-family: var(--font-main);
  background: var(--bg-dark);
  color: var(--text-main);
  display: flex;
  justify-content: center;
  align-items: center;
}

/* Background Animations */
#background-goobys {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: -1;
  overflow: hidden;
}

.bg-gooby {
  position: absolute;
  border-radius: 50%;
  filter: blur(40px);
  /* Reduced from 80px for better FPS */
  opacity: 0.5;
  /* Reduced from 0.6 */
  animation: float 20s infinite ease-in-out;
  will-change: transform;
  /* GPU acceleration */
}

.b1 {
  width: 400px;
  height: 400px;
  background: #4f46e5;
  top: -100px;
  left: -100px;
}

.b2 {
  width: 300px;
  height: 300px;
  background: #ec4899;
  bottom: -50px;
  right: -50px;
  animation-delay: -5s;
}

.b3 {
  width: 250px;
  height: 250px;
  background: #06b6d4;
  bottom: 30%;
  left: 30%;
  animation-delay: -10s;
}

/* Animations */
@keyframes float {

  0%,
  100% {
    transform: translateY(0);
  }

  50% {
    transform: translateY(-10px);
  }
}

@keyframes spin {
  to {
    transform: rotate(360deg);
  }
}

/* APP CONTAINER (Canvas Holder) */
#app {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  display: block;
  z-index: 0;
  overflow: hidden;
}

#app canvas {
  display: block;
  width: 100%;
  height: 100%;
  opacity: 1;
  /* Full visibility */
}

/* MAIN MENU (Above Canvas) */
#mainMenu {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  z-index: 10;
  pointer-events: auto;
  background: rgba(15, 23, 42, 0.6);
  /* More transparent to see goobys */
  backdrop-filter: blur(3px);
  padding: 20px;
  box-sizing: border-box;
  overflow-y: auto;
  /* Allow scrolling on small screens */
}

/* Responsive title sizing */
#mainMenu h1 {
  font-size: clamp(2rem, 8vw, 4rem);
  /* Responsive font */
  margin: 10px 0;
}

#mainMenu h2 {
  font-size: clamp(1rem, 4vw, 1.5rem);
  margin: 10px 0;
}

.loading-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.8);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  z-index: 10000;
  backdrop-filter: blur(5px);
}

.loading-spinner {
  width: 60px;
  height: 60px;
  border: 4px solid rgba(255, 255, 255, 0.1);
  border-top-color: var(--accent);
  border-radius: 50%;
  animation: spin 1s linear infinite;
  margin-bottom: 1rem;
}

.loading-text {
  color: white;
  font-size: 1.1rem;
  margin-bottom: 0.5rem;
}

.loading-subtext {
  color: rgba(255, 255, 255, 0.6);
  font-size: 0.9rem;
}

/* Dialog Overlay */
.dialog-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.85);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 10001;
  backdrop-filter: blur(4px);
}

.dialog-box {
  background: rgba(15, 23, 42, 0.95);
  padding: 2rem;
  border-radius: 12px;
  border: 1px solid rgba(255, 255, 255, 0.1);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
  min-width: 400px;
  animation: dialogSlideIn 0.3s ease;
}

.dialog-box h2 {
  margin-top: 0;
  margin-bottom: 1.5rem;
  color: white;
}

.dialog-box input {
  width: 100%;
  margin-bottom: 1rem;
}

@keyframes dialogSlideIn {
  from {
    opacity: 0;
    transform: scale(0.9) translateY(-20px);
  }

  to {
    opacity: 1;
    transform: scale(1) translateY(0);
  }
}

/* Button Face Styles */
.btn-face {
  padding: 0.5rem 1rem;
  border-radius: 8px;
  border: 2px solid rgba(255, 255, 255, 0.2);
  background: rgba(0, 0, 0, 0.3);
  color: white;
  cursor: pointer;
  transition: all 0.2s;
}

.btn-face:hover {
  border-color: var(--accent);
  background: rgba(236, 72, 153, 0.2);
}

.btn-face.selected {
  border-color: var(--accent);
  background: var(--accent);
  color: white;
}

/* Glassmorphism Containers */

.glass-panel {
  background: var(--glass-bg);
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);
  border: 1px solid var(--glass-border);
  border-radius: 24px;
  padding: 2.5rem;
  box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
  text-align: center;
  animation: fadeUp 0.6s cubic-bezier(0.16, 1, 0.3, 1);
}

@keyframes fadeUp {
  from {
    opacity: 0;
    transform: translateY(20px);
  }

  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* Typography */
h1 {
  font-weight: 800;
  font-size: 3rem;
  margin: 0 0 0.5rem 0;
  background: linear-gradient(135deg, #fff 0%, #cbd5e1 100%);
  -webkit-background-clip: text;
  background-clip: text;
  -webkit-text-fill-color: transparent;
  letter-spacing: -2px;
}

h2 {
  font-size: 1.5rem;
  font-weight: 600;
  margin-bottom: 1.5rem;
}

.selection-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
  gap: 1rem;
  margin-top: 1.5rem;
  justify-content: center;
  width: 100%;
  max-width: 1000px;
  padding: 0 1rem;
  box-sizing: border-box;
}

.selection-card {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid var(--glass-border);
  border-radius: 12px;
  padding: 1rem;
  /* width: 200px; removed fixed width for grid */
  cursor: pointer;
  transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
  text-align: center;
  position: relative;
  overflow: hidden;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
}

.selection-card h3 {
  margin: 0.5rem 0;
  color: var(--primary);
  font-size: 0.9rem;
  line-height: 1.2;
}

.selection-card p {
  font-size: 0.75rem;
  color: #ccc;
  line-height: 1.2;
  margin: 0;
  display: none;
  /* Hide desc to save space if needed, or keep small */
}

.selection-card:hover p {
  display: block;
  /* Show on hover? */
}

/* Force desc display if space permits, or just rely on title/icon */
.selection-card p {
  display: block;
  margin-top: 5px;
}

.card-icon {
  font-size: 2rem;
  margin-bottom: 0.2rem;
  display: block;
}

/* Map specific backgrounds */
.selection-card.map-desert {
  background-image: linear-gradient(rgba(0, 0, 0, 0.4), rgba(0, 0, 0, 0.4)), url('https://via.placeholder.com/150/d2b48c/FFFFFF?text=Desert');
  background-size: cover;
  background-position: center;
}

.selection-card.map-forest {
  background-image: linear-gradient(rgba(0, 0, 0, 0.4), rgba(0, 0, 0, 0.4)), url('https://via.placeholder.com/150/228b22/FFFFFF?text=Forest');
  background-size: cover;
  background-position: center;
}

.selection-card.map-ice {
  background-image: linear-gradient(rgba(0, 0, 0, 0.4), rgba(0, 0, 0, 0.4)), url('https://via.placeholder.com/150/add8e6/FFFFFF?text=Ice');
  background-size: cover;
  background-position: center;
}

p {
  color: var(--text-muted);
}

/* Form Elements */
input {
  width: 100%;
  padding: 1rem;
  background: rgba(0, 0, 0, 0.3);
  border: 1px solid var(--glass-border);
  border-radius: 12px;
  color: white;
  font-size: 1rem;
  font-family: inherit;
  margin-bottom: 1rem;
  box-sizing: border-box;
  transition: all 0.2s;
}

input:focus {
  outline: none;
  border-color: var(--primary);
  background: rgba(0, 0, 0, 0.5);
}

.btn {
  width: 100%;
  padding: 1rem;
  border: none;
  border-radius: 12px;
  font-size: 1rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s;
  margin-bottom: 0.8rem;
  font-family: inherit;
}

.btn-primary {
  background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
  color: white;
  box-shadow: 0 4px 15px rgba(79, 70, 229, 0.4);
}

.btn-primary:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 25px rgba(79, 70, 229, 0.5);
}

.btn-secondary {
  background: rgba(255, 255, 255, 0.1);
  color: white;
}

.btn-secondary:hover {
  background: rgba(255, 255, 255, 0.15);
}

/* Gooby Character Preview */
.character-preview {
  width: 120px;
  height: 120px;
  margin: 0 auto 2rem auto;
  position: relative;
}

.gooby-char {
  width: 100%;
  height: 100%;
  border-radius: 64% 36% 27% 73% / 55% 58% 42% 45%;
  transition: all 0.5s ease;
  animation: goobyPulse 4s infinite ease-in-out;
  box-shadow: inset -10px -10px 20px rgba(0, 0, 0, 0.3), inset 10px 10px 20px rgba(255, 255, 255, 0.4);
}

@keyframes goobyPulse {

  0%,
  100% {
    border-radius: 64% 36% 27% 73% / 55% 58% 42% 45%;
  }

  50% {
    border-radius: 30% 70% 70% 30% / 30% 30% 70% 70%;
  }
}

/* Color Picker Grid */
.color-grid {
  display: flex;
  justify-content: center;
  gap: 10px;
  margin-bottom: 2rem;
}

.color-option {
  width: 32px;
  height: 32px;
  border-radius: 50%;
  cursor: pointer;
  border: 2px solid transparent;
  transition: transform 0.2s;
}

.color-option.selected {
  border-color: white;
  transform: scale(1.2);
}

/* Lobby Styling */
.lobby-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1rem;
}

.lobby-code-box {
  background: rgba(0, 0, 0, 0.3);
  padding: 0.5rem 1rem;
  border-radius: 8px;
  font-family: monospace;
  font-size: 1.2rem;
  letter-spacing: 2px;
  border: 1px dashed var(--glass-border);
}

.player-list {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
  gap: 0.8rem;
  margin-bottom: 1.5rem;
  max-height: 400px;
  overflow-y: auto;
  padding-right: 5px;
  /* Space for scrollbar */
}

/* Custom scrollbar for player list */
.player-list::-webkit-scrollbar {
  width: 6px;
}

.player-list::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 3px;
}

.player-list::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 3px;
}

.player-card {
  display: flex;
  flex-direction: column;
  /* Stack avatar and info */
  align-items: center;
  background: rgba(255, 255, 255, 0.05);
  padding: 1rem;
  border-radius: 12px;
  gap: 0.5rem;
  transition: transform 0.2s;
  position: relative;
  border: 1px solid transparent;
}

.player-card:hover {
  background: rgba(255, 255, 255, 0.1);
  transform: translateY(-2px);
  border-color: var(--glass-border);
}

.player-avatar-small {
  width: 48px;
  height: 48px;
  border-radius: 50%;
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
  border: 2px solid rgba(255, 255, 255, 0.2);
}

.player-info {
  text-align: center;
  width: 100%;
}

.player-name {
  font-weight: 600;
  font-size: 0.9rem;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  display: block;
  margin-bottom: 4px;
}

.ping-badge {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  font-size: 0.75rem;
  color: var(--text-muted);
  background: rgba(0, 0, 0, 0.3);
  padding: 2px 6px;
  border-radius: 10px;
}

.ping-dot {
  width: 6px;
  height: 6px;
  border-radius: 50%;
  background-color: #22c55e;
  /* Green */
}

/* Dynamic ping colors */
.ping-green {
  background-color: #22c55e;
  color: #86efac;
}

.ping-yellow {
  background-color: #eab308;
  color: #fde047;
}

.ping-red {
  background-color: #ef4444;
  color: #fca5a5;
}

.scroll-area {
  max-height: 300px;
  overflow-y: auto;
  margin-bottom: 1rem;
}

.lobby-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  background: rgba(255, 255, 255, 0.03);
  padding: 1rem;
  margin-bottom: 0.5rem;
  border-radius: 12px;
  transition: background 0.2s;
}

.lobby-item:hover {
  background: rgba(255, 255, 255, 0.08);
}

/* Add Game Canvas Style */
.game-canvas {
  display: block;
  width: 100vw;
  height: 100vh;
  /* Cursor crosshair for aiming */
  cursor: crosshair;
}

/* UI Overlay for Game (Score, etc.) - To be used later */
.game-ui {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  /* Cover full screen to allow absolute children positioning relative to it */
  padding: 1rem;
  pointer-events: none;
  /* Let clicks pass through to canvas */
  box-sizing: border-box;
}

/* Helper to position children with pointer events */
.game-ui>* {
  pointer-events: auto;
}

/* Selection Screen Overlay */
.selection-overlay {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(15, 23, 42, 0.9);
  backdrop-filter: blur(8px);
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  z-index: 100;
  animation: fadeIn 0.5s ease;
}

/* ... existing selection styles ... */

/* Leaderboard */
.leaderboard {
  position: absolute;
  top: 1rem;
  left: 1rem;
  /* Moved to Left as per standard or user pref? User said "right top is out of screen", implying Quit button. I'll put leaderboard Top Left or Top Right? User didn't specify pos, just said "Right top quit button is out of screen". I will put Quit button Top Right properly, and Leaderboard Top Left. */
  background: rgba(15, 23, 42, 0.6);
  backdrop-filter: blur(10px);
  padding: 1rem;
  border-radius: 16px;
  border: 1px solid var(--glass-border);
  min-width: 220px;
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
  transition: transform 0.3s ease;
}

.leaderboard:hover {
  transform: scale(1.02);
  background: rgba(15, 23, 42, 0.8);
}

.leaderboard h3 {
  margin: 0 0 0.8rem 0;
  font-size: 1.1rem;
  color: white;
  border-bottom: 1px solid var(--glass-border);
  padding-bottom: 0.5rem;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.lb-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 0.5rem;
  font-size: 0.95rem;
  padding: 0.5rem;
  border-radius: 8px;
  background: rgba(255, 255, 255, 0.05);
}

.lb-left {
  display: flex;
  align-items: center;
  gap: 8px;
}

.lb-dot {
  width: 10px;
  height: 10px;
  border-radius: 50%;
  box-shadow: 0 0 5px currentColor;
}

.lb-name {
  font-weight: 500;
  color: #e2e8f0;
}

.lb-score {
  font-weight: 800;
  color: var(--accent);
}

/* Ability Toast */
.ability-toast {
  position: absolute;
  top: 10%;
  left: 50%;
  transform: translateX(-50%);
  background: linear-gradient(90deg, transparent, rgba(99, 102, 241, 0.8), transparent);
  padding: 1rem 3rem;
  color: white;
  font-size: 1.5rem;
  font-weight: 800;
  text-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
  pointer-events: none;
  animation: slideDownFade 3s ease forwards;
  z-index: 50;
  white-space: nowrap;
}

@keyframes slideDownFade {
  0% {
    opacity: 0;
    transform: translate(-50%, -20px);
  }

  10% {
    opacity: 1;
    transform: translate(-50%, 0);
  }

  80% {
    opacity: 1;
    transform: translate(-50%, 0);
  }

  100% {
    opacity: 0;
    transform: translate(-50%, 20px);
  }
}

/* Custom Color Picker input styling */
.color-picker-wrapper {
  position: relative;
  width: 32px;
  height: 32px;
  border-radius: 50%;
  overflow: hidden;
  cursor: pointer;
  border: 2px solid transparent;
  display: flex;
  align-items: center;
  justify-content: center;
  background: conic-gradient(red, yellow, lime, aqua, blue, magenta, red);
}

.color-picker-wrapper input[type="color"] {
  position: absolute;
  top: -50%;
  left: -50%;
  width: 200%;
  height: 200%;
  padding: 0;
  margin: 0;
  cursor: pointer;
  opacity: 0;
}

/* Voting System Styles */
.vote-count-area {
  display: flex;
  flex-wrap: wrap;
  gap: 5px;
  justify-content: center;
  margin-top: 1rem;
  min-height: 30px;
}

.vote-avatar {
  width: 24px;
  height: 24px;
  border-radius: 50%;
  border: 2px solid white;
  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.5);
  animation: popIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}

@keyframes popIn {
  from {
    transform: scale(0);
  }

  to {
    transform: scale(1);
  }
}

.winning-card {
  border-color: #4ade80 !important;
  background: rgba(74, 222, 128, 0.2) !important;
  box-shadow: 0 0 30px rgba(74, 222, 128, 0.4) !important;
  transform: scale(1.05);
}

/* Auto-hide ads if empty (no ad loaded) */
.ad-slot:empty {
  display: none !important;
}

body::after {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  pointer-events: none;
  z-index: 9999;
  background: radial-gradient(circle, transparent 60%, rgba(220, 20, 60, 0.8) 100%);
  opacity: 0;
  transition: opacity 0.1s linear;
  will-change: opacity;
}

body.panic-mode::after {
  opacity: var(--panic-opacity, 1);
  animation: pulseRed 0.5s infinite alternate;
}

@keyframes pulseRed {
  from {
    box-shadow: inset 0 0 50px rgba(255, 0, 0, 0.2);
  }

  to {
    box-shadow: inset 0 0 150px rgba(255, 0, 0, 0.6);
  }
}

/* --- IMPORTED FROM INDEX.HTML --- */

:root {
  --font-main: 'Outfit', sans-serif;
  --font-display: 'Russo One', sans-serif;
  --font-tech: 'Orbitron', sans-serif;
}

/* Liquid Text Animation */
@keyframes flow {
  0% {
    background-position: 0% 50%;
  }

  50% {
    background-position: 100% 50%;
  }

  100% {
    background-position: 0% 50%;
  }
}

.liquid-text {
  background: linear-gradient(270deg, #3b82f6, #8b5cf6, #ef4444, #3b82f6);
  background-size: 300% 300%;
  -webkit-background-clip: text;
  background-clip: text;
  -webkit-text-fill-color: transparent;
  animation: flow 5s ease infinite;
  filter: drop-shadow(0 0 10px rgba(139, 92, 246, 0.5));
}

/* 3D Tilt */
.tilt-container {
  perspective: 1000px;
  transform-style: preserve-3d;
}

.tilt-panel {
  transition: transform 0.1s ease-out;
  transform-style: preserve-3d;
}

/* Tarot Cards (Voting) */
.tarot-grid {
  display: flex;
  justify-content: center;
  gap: 20px;
  perspective: 1000px;
}

.tarot-card {
  width: 180px;
  height: 260px;
  background: rgba(15, 23, 42, 0.8);
  border: 2px solid rgba(255, 255, 255, 0.1);
  border-radius: 15px;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
  position: relative;
  overflow: hidden;
  animation: slideUp 0.5s ease backwards;
}

.tarot-card:hover {
  transform: translateY(-20px) scale(1.05);
  border-color: #facc15;
  box-shadow: 0 20px 40px rgba(250, 204, 21, 0.3);
  background: rgba(15, 23, 42, 0.95);
  z-index: 10;
}

@keyframes popIn {
  from {
    transform: scale(0.5);
    opacity: 0;
  }

  to {
    transform: scale(1);
    opacity: 1;
  }
}

@keyframes slideUp {
  from {
    transform: translateY(50px);
    opacity: 0;
  }

  to {
    transform: translateY(0);
    opacity: 1;
  }
}

/* Fonts Override */
h1,
h2,
h3 {
  font-family: var(--font-display);
  letter-spacing: 1px;
}

button {
  font-family: var(--font-tech) !important;
  text-transform: uppercase;
  letter-spacing: 2px;
}
/* Ultrawide & TV Optimizations */

/* Ultrawide monitors (21:9, 32:9) */
@media (min-width: 2560px) {
    .main-menu-panel {
        max-width: 800px;
        margin: 0 auto;
    }
    
    button {
        font-size: 1.2rem;
        padding: 1rem 2rem;
    }
    
    h1 { font-size: 4rem; }
    h2 { font-size: 2.5rem; }
}

/* 4K/8K displays */
@media (min-width: 3840px) {
    .main-menu-panel {
        max-width: 1200px;
        transform: scale(1.3);
    }
    
    #leaderboard {
        font-size: 1.2rem;
    }
}

/* TV/Console mode (16:9, 10ft viewing) */
@media (min-height: 1080px) and (min-width: 1920px) {
    body {
        font-size: 120%;
    }
    
    button {
        font-size: 1.3rem;
        padding: 1.2rem 2.5rem;
    }
    
    .main-menu-panel {
        transform: scale(1.2);
    }
    
    #leaderboard {
        font-size: 1.1rem;
        padding: 1.5rem;
    }
}
